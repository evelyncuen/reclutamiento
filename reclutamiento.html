<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Formulario de Reclutamiento</title>
<style>
body { font-family: Arial; margin: 40px; background: #f5f5f5; }
form { background: white; padding: 20px; border-radius: 10px; max-width: 700px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
h3 { margin-top: 30px; }
label { display: block; margin-top: 10px; font-weight: bold; }
input, textarea, select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; }
button { margin-top: 20px; padding: 10px 15px; background: #007BFF; color: white; border: none; border-radius: 5px; cursor: pointer; }
button:hover { background: #0056b3; }
#resultado { margin-top: 15px; font-weight: bold; }
.reference-group { border: 1px solid #ccc; padding: 10px; margin-top: 10px; border-radius: 5px; }
.file-input { margin-top: 5px; }
</style>
</head>
<body>

<h2>Formulario de Reclutamiento</h2>
<form id="formulario">

<h3>Sección 1: Datos personales</h3>
<label>Nombre:</label><input type="text" name="nombre" required>
<label>Apellido Paterno:</label><input type="text" name="apellido_paterno" required>
<label>Apellido Materno:</label><input type="text" name="apellido_materno" required>
<label>Lugar de Nacimiento:</label><input type="text" name="lugar_nacimiento" required>
<label>Fecha de Nacimiento:</label><input type="date" name="fecha_nacimiento" required>
<label>Edad:</label><input type="number" name="edad" required>
<label>Nacionalidad:</label><input type="text" name="nacionalidad" required>
<label>Sexo:</label>
<select name="sexo" required>
  <option value="">Seleccione</option>
  <option value="Masculino">Masculino</option>
  <option value="Femenino">Femenino</option>
  <option value="Otro">Otro</option>
</select>

<h3>Sección 2: Domicilio y Contacto</h3>
<label>Calle y Número:</label><input type="text" name="calle_numero" required>
<label>Colonia:</label><input type="text" name="colonia" required>
<label>Código Postal:</label><input type="text" name="codigo_postal" required>
<label>Teléfono Fijo:</label><input type="text" name="telefono_fijo">
<label>Celular:</label><input type="text" name="celular" required>
<label>Correo Electrónico:</label><input type="email" name="correo" required>

<h3>Sección 3: Información general</h3>
<label>RFC:</label><input type="text" name="rfc" required>
<label>NSS:</label><input type="text" name="nss" required>
<label>CURP:</label><input type="text" name="curp" required>

<h3>Sección 4: Referencias personales</h3>
<div class="reference-group">
  <h4>Referencia 1</h4>
  <label>Nombre Completo:</label><input type="text" name="ref1_nombre">
  <label>Teléfono:</label><input type="text" name="ref1_telefono">
  <label>Domicilio:</label><input type="text" name="ref1_domicilio">
  <label>Ocupación:</label><input type="text" name="ref1_ocupacion">
  <label>Tiempo de conocerlo:</label><input type="text" name="ref1_tiempo">
</div>

<div class="reference-group">
  <h4>Referencia 2</h4>
  <label>Nombre Completo:</label><input type="text" name="ref2_nombre">
  <label>Teléfono:</label><input type="text" name="ref2_telefono">
  <label>Domicilio:</label><input type="text" name="ref2_domicilio">
  <label>Ocupación:</label><input type="text" name="ref2_ocupacion">
  <label>Tiempo de conocerlo:</label><input type="text" name="ref2_tiempo">
</div>

<div class="reference-group">
  <h4>Referencia 3</h4>
  <label>Nombre Completo:</label><input type="text" name="ref3_nombre">
  <label>Teléfono:</label><input type="text" name="ref3_telefono">
  <label>Domicilio:</label><input type="text" name="ref3_domicilio">
  <label>Ocupación:</label><input type="text" name="ref3_ocupacion">
  <label>Tiempo de conocerlo:</label><input type="text" name="ref3_tiempo">
</div>

<h3>Sección 5: Documentos Requeridos</h3>
<label>Acta de Nacimiento:</label><input type="file" name="acta_nacimiento" class="file-input">
<label>Constancia de Estudios:</label><input type="file" name="constancia_estudios" class="file-input">
<label>Carta de No Antecedentes Penales:</label><input type="file" name="carta_antecedentes" class="file-input">
<label>INE:</label><input type="file" name="ine" class="file-input">
<label>RFC:</label><input type="file" name="rfc_doc" class="file-input">
<label>CURP:</label><input type="file" name="curp_doc" class="file-input">
<label>NSS:</label><input type="file" name="nss_doc" class="file-input">
<label>Comprobante de Domicilio:</label><input type="file" name="comprobante_domicilio" class="file-input">

<h3>Sección 6: Consentimientos y Firma Digital</h3>
<label><input type="checkbox" name="consent_empleadores"> Autorizo a Grupo SSPI a consultar con mis empleadores anteriores sobre mi desempeño laboral</label>
<label><input type="checkbox" name="consent_antecedentes"> Autorizo la verificación de antecedentes penales y crediticios</label>
<label>Nombre completo para firma:</label><input type="text" name="firma_nombre">
<label>Fecha:</label><input type="date" name="firma_fecha">

<button type="submit">Enviar</button>
</form>

<p id="resultado"></p>

<script>
document.getElementById("formulario").addEventListener("submit", async function(e){
  e.preventDefault();

  const form = e.target;
  const formData = new FormData(form);

  // Convertir los datos en objeto
  const data = {};
  formData.forEach((value, key) => {
    if (data[key]) {
      if (!Array.isArray(data[key])) data[key] = [data[key]];
      data[key].push(value);
    } else {
      data[key] = value;
    }
  });

  // Procesar archivos
  const files = [];
  for (const input of form.querySelectorAll('input[type="file"]')) {
    if (input.files.length > 0) {
      const file = input.files[0];
      const content = await toBase64(file);
      files.push({name: file.name, content: content.split(",")[1], mimeType: file.type});
    }
  }
  data.files = files;

  // Checkboxes
  data.consent_empleadores = form.querySelector('[name="consent_empleadores"]').checked;
  data.consent_antecedentes = form.querySelector('[name="consent_antecedentes"]').checked;

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbyMLOOaylhQ-42PiOaHyn9lgdQl0szzUVELdpyMf622lcCw_udBKcorc2l93RZfmowi/exec", {
      method: "POST",
      body: JSON.stringify(data),
      headers: {"Content-Type": "application/json"}
    });

    const result = await response.json();
    document.getElementById("resultado").innerText = "✅ " + result.message;
  } catch (error) {
    document.getElementById("resultado").innerText = "❌ Error al enviar: " + error.message;
  }
});

function toBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
  });
}
</script>

</body>
</html>

